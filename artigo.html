<!DOCTYPE html>
<html lang="pt-MZ">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lendo - CLD</title>
    <link href="https://fonts.googleapis.com/css2?family=Google+Sans:wght@400;500;700&family=Georgia&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --text: #202124; --bg: #ffffff; --primary: #1a73e8; }
        body.dark-mode { --text: #e8eaed; --bg: #101114; }
        body { font-family: 'Google Sans', sans-serif; background: var(--bg); color: var(--text); line-height: 1.6; }
        
        .nav { position: sticky; top: 0; background: var(--bg); padding: 12px; border-bottom: 1px solid #dadce0; display: flex; justify-content: space-between; z-index: 100; }
        .container { max-width: 700px; margin: 0 auto; padding: 24px 16px; }
        
        h1 { font-size: 32px; line-height: 1.2; font-weight: 500; margin-bottom: 20px; }
        .meta { color: var(--primary); font-weight: 700; font-size: 14px; margin-bottom: 16px; display: block; }
        .main-img { width: 100%; border-radius: 16px; margin-bottom: 24px; }
        
        .content { font-family: 'Georgia', serif; font-size: 20px; line-height: 1.8; }
        .content p { margin-bottom: 24px; }
        .content img { max-width: 100%; border-radius: 8px; }

        /* Agregador Final */
        .related { margin-top: 50px; padding-top: 30px; border-top: 2px solid #eee; }
        .related-title { font-size: 20px; font-weight: 700; margin-bottom: 20px; }
        .related-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .rel-card { display: flex; gap: 8px; text-decoration: none; color: inherit; font-size: 13px; font-weight: 500; background: #f8f9fa; padding: 8px; border-radius: 8px; }
        .rel-card img { width: 60px; height: 60px; border-radius: 4px; object-fit: cover; }
        
        @media (max-width: 600px) { .related-grid { grid-template-columns: 1fr; } }
    </style>
</head>
<body>

<nav class="nav">
    <a href="index.html" style="color:inherit; text-decoration:none"><i class="fas fa-arrow-left"></i> Voltar</a>
    <i class="fas fa-share-alt" onclick="share()" style="cursor:pointer"></i>
</nav>

<article class="container">
    <span class="meta" id="meta-src"></span>
    <h1 id="title">Carregando...</h1>
    <img src="" id="img" class="main-img">
    <div class="content" id="content"></div>

    <section class="related">
        <div class="related-title">Mais para ler</div>
        <div class="related-grid" id="related-news"></div>
    </section>
</article>

<script>
    const API_MAP = {
        'opais': { name: 'O PAÃS', url: 'https://opais.co.mz/wp-json/wp/v2/posts/' },
        'carta': { name: 'CARTA MZ', url: 'https://cartamz.com/wp-json/wp/v2/posts/' }
    };

    async function load() {
        const urlParams = new URLSearchParams(window.location.search);
        const id = urlParams.get('id');
        const src = urlParams.get('src');
        
        try {
            const res = await fetch(`${API_MAP[src].url}${id}?_embed`);
            const data = await res.json();
            
            document.getElementById('meta-src').innerText = API_MAP[src].name;
            document.getElementById('title').innerHTML = data.title.rendered;
            document.getElementById('img').src = data._embedded?.['wp:featuredmedia']?.[0]?.source_url || '';
            document.getElementById('content').innerHTML = data.content.rendered;
            
            loadRelated(src);
        } catch(e) {}
    }

    async function loadRelated(src) {
        const res = await fetch(`${API_MAP[src].url}?per_page=6&_embed`);
        const data = await res.json();
        const container = document.getElementById('related-news');
        
        data.forEach(p => {
            container.innerHTML += `
                <a href="artigo.html?id=${p.id}&src=${src}" class="rel-card">
                    <img src="${p._embedded?.['wp:featuredmedia']?.[0]?.source_url || ''}">
                    <span>${p.title.rendered}</span>
                </a>
            `;
        });
    }

    function share() {
        navigator.share({ title: document.title, url: window.location.href });
    }

    window.onload = load;
</script>
</body>
</html>
